<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Estado del Proyecto - Neon Signs</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8fafc;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #1e293b;
            border-bottom: 2px solid #3b82f6;
            padding-bottom: 12px;
        }

        .test-section {
            margin: 24px 0;
            padding: 16px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
        }

        .test-section h3 {
            margin-top: 0;
            color: #334155;
        }

        .status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: 500;
            font-size: 14px;
        }

        .status.success {
            background: #dcfce7;
            color: #166534;
        }

        .status.error {
            background: #fee2e2;
            color: #991b1b;
        }

        .status.warning {
            background: #fef3c7;
            color: #92400e;
        }

        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            margin: 4px;
        }

        button:hover {
            background: #2563eb;
        }

        .result {
            margin: 12px 0;
            padding: 12px;
            background: #f1f5f9;
            border-radius: 6px;
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üß™ Test Estado del Proyecto - Neon Signs</h1>

        <div class="test-section">
            <h3>üîß Configuraci√≥n Firebase</h3>
            <button onclick="testFirebaseConfig()">Verificar Configuraci√≥n</button>
            <div id="config-result" class="result"></div>
        </div>

        <div class="test-section">
            <h3>üîê Autenticaci√≥n</h3>
            <button onclick="checkAuthStatus()">Verificar Estado Auth</button>
            <button onclick="goToLogin()">Ir a Login Admin</button>
            <div id="auth-result" class="result"></div>
        </div>

        <div class="test-section">
            <h3>üìä Base de Datos</h3>
            <button onclick="testFirestore()">Verificar Firestore</button>
            <button onclick="loadGalleryData()">Cargar Datos Galer√≠a</button>
            <div id="firestore-result" class="result"></div>
        </div>

        <div class="test-section">
            <h3>üì§ Storage</h3>
            <button onclick="testStorage()">Verificar Storage</button>
            <div id="storage-result" class="result"></div>
        </div>

        <div class="test-section">
            <h3>üñºÔ∏è Panel Admin</h3>
            <button onclick="goToAdmin()">Ir a Panel Admin</button>
            <button onclick="goToGalleryManager()">Ir a Gallery Manager</button>
            <div id="admin-result" class="result"></div>
        </div>

        <div class="test-section">
            <h3>üåê Frontend</h3>
            <button onclick="goToHome()">Ir a Home</button>
            <button onclick="goToProducts()">Ir a Productos</button>
            <div id="frontend-result" class="result"></div>
        </div>
    </div>

    <script type="module">
        // Test Firebase Configuration
        window.testFirebaseConfig = function () {
            const result = document.getElementById('config-result');

            try {
                const requiredVars = [
                    'VITE_FIREBASE_API_KEY',
                    'VITE_FIREBASE_AUTH_DOMAIN',
                    'VITE_FIREBASE_PROJECT_ID',
                    'VITE_FIREBASE_STORAGE_BUCKET',
                    'VITE_FIREBASE_MESSAGING_SENDER_ID',
                    'VITE_FIREBASE_APP_ID'
                ];

                const status = [];
                requiredVars.forEach(varName => {
                    const value = import.meta.env[varName];
                    status.push(`${varName}: ${value ? '‚úÖ OK' : '‚ùå MISSING'}`);
                });

                const projectId = import.meta.env.VITE_FIREBASE_PROJECT_ID;
                status.push(`\nProject ID: ${projectId}`);
                status.push(`Expected: neon-signs-app`);
                status.push(`Match: ${projectId === 'neon-signs-app' ? '‚úÖ YES' : '‚ùå NO'}`);

                result.innerHTML = status.join('\n');
            } catch (error) {
                result.innerHTML = `‚ùå Error: ${error.message}`;
            }
        };

        // Check Authentication Status
        window.checkAuthStatus = async function () {
            const result = document.getElementById('auth-result');

            try {
                // Import auth service
                const { authService } = await import('/src/services/auth.service');
                const user = authService.getCurrentUser();

                if (user) {
                    result.innerHTML = `‚úÖ Usuario logueado: ${user.email}\n` +
                        `Admin: ${user.email === 'tecnofusion.it@gmail.com' ? '‚úÖ YES' : '‚ùå NO'}`;
                } else {
                    result.innerHTML = '‚ùå No hay usuario logueado\n' +
                        'Necesitas hacer login en /admin/login';
                }
            } catch (error) {
                result.innerHTML = `‚ùå Error checking auth: ${error.message}`;
            }
        };

        // Test Firestore
        window.testFirestore = async function () {
            const result = document.getElementById('firestore-result');
            result.innerHTML = 'üîÑ Conectando a Firestore...';

            try {
                const { FirestoreService } = await import('/src/services/firestore.service');

                // Test b√°sico: obtener todos los items
                const items = await FirestoreService.getItems();

                result.innerHTML = `‚úÖ Firestore conectado\n` +
                    `Total items: ${items.length}\n` +
                    `Estructura OK: ${items.length > 0 ? '‚úÖ' : '‚ö†Ô∏è Sin datos'}`;

                if (items.length > 0) {
                    const sample = items[0];
                    result.innerHTML += `\n\nSample item:\n` +
                        `- ID: ${sample.id}\n` +
                        `- Title: ${sample.title}\n` +
                        `- Category: ${sample.category}\n` +
                        `- Featured: ${sample.isFeatured}\n` +
                        `- Active: ${sample.isActive}`;
                }
            } catch (error) {
                result.innerHTML = `‚ùå Error Firestore: ${error.message}`;
            }
        };

        // Load Gallery Data
        window.loadGalleryData = async function () {
            const result = document.getElementById('firestore-result');
            result.innerHTML = 'üîÑ Cargando datos de galer√≠a...';

            try {
                const { useGallery } = await import('/src/composables/useGallery');
                const { fetchItems, items } = useGallery();

                await fetchItems();

                result.innerHTML = `‚úÖ Datos cargados desde composable\n` +
                    `Items reactivos: ${items.value.length}`;
            } catch (error) {
                result.innerHTML = `‚ùå Error cargando galer√≠a: ${error.message}`;
            }
        };

        // Test Storage
        window.testStorage = async function () {
            const result = document.getElementById('storage-result');

            try {
                const { StorageService } = await import('/src/services/storage.service');

                // Test validaci√≥n de archivos
                const testFile = new File(['test'], 'test.jpg', { type: 'image/jpeg' });
                const validation = StorageService.validateFile(testFile);

                result.innerHTML = `‚úÖ Storage service OK\n` +
                    `File validation: ${validation.valid ? '‚úÖ OK' : '‚ùå FAIL'}\n` +
                    `Error: ${validation.error || 'None'}`;
            } catch (error) {
                result.innerHTML = `‚ùå Error Storage: ${error.message}`;
            }
        };

        // Navigation functions
        window.goToLogin = () => window.open('/admin/login', '_blank');
        window.goToAdmin = () => window.open('/admin', '_blank');
        window.goToGalleryManager = () => window.open('/admin/gallery', '_blank');
        window.goToHome = () => window.open('/', '_blank');
        window.goToProducts = () => window.open('/productos', '_blank');

        // Auto-run config test on load
        setTimeout(() => {
            testFirebaseConfig();
        }, 500);
    </script>
</body>

</html>